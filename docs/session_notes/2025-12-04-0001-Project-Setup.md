# Session Notes: Project Setup

**Date**: 2025-12-04
**Session ID**: 0001
**Focus**: Complete project initialization and development environment setup

---

## Session Summary

Complete initialization of the Virtual Table Top (VTT) project including:
- Documentation structure and architecture specs
- MVP scope definition and prioritization
- Tech stack selection (Svelte + PixiJS + Fastify)
- Full monorepo development environment setup
- Database schema and migrations

## What Was Accomplished

### Documentation Structure Created

```
D:\Projects\VTT\
├── README.md                    # Project overview and getting started
├── PROJECT_OUTLINE.md           # Development plan and feature roadmap
├── CLAUDE.md                    # AI assistant instructions (pre-existing)
└── docs/
    ├── README.md                # Documentation hub
    ├── reports/
    │   └── README.md            # Implementation reports folder
    ├── guides/
    │   └── README.md            # User and developer guides folder
    ├── session_notes/
    │   └── README.md            # Session notes folder (+ this file)
    └── architecture/
        ├── README.md            # Architecture docs folder
        ├── SYSTEM_OVERVIEW.md   # System architecture (placeholder)
        └── DATABASE_DESIGN.md   # Database schema (placeholder)
```

### Key Documents

1. **README.md** - Professional project overview with features, tech stack considerations, and documentation links
2. **PROJECT_OUTLINE.md** - Comprehensive development plan with:
   - 4 development phases
   - Prioritized feature list
   - Technical considerations
   - Open questions for decisions
   - Success metrics

### Documentation Files Organized

Organized 9 additional documentation files into the architecture folder:

| File | Description |
|------|-------------|
| **API.md** | REST & WebSocket API specifications |
| **AUTH.md** | Authentication system (OAuth, 2FA, sessions) |
| **CHAT.md** | Text/voice/video chat with LiveKit |
| **DATABASE.md** | Complete PostgreSQL schema |
| **GAME_SYSTEMS.md** | Abstract TTRPG framework, dice engines |
| **MARKETPLACE.md** | Paid GM marketplace with Stripe Connect |
| **STREAMING.md** | Twitch/YouTube/Kick integration |

Project-level docs (PROJECT.md, PROJECT_OUTLINE.md) remain in docs/ root.

## MVP Scope Defined

After reviewing all architecture docs and discussing priorities, created `docs/MVP_SCOPE.md` with:

### MVP Priority Order
1. **Dice System** - Universal dice engine with multiple notation support
2. **Maps** - Two types: user-uploaded custom maps AND server-generated dynamic maps
3. **Tokens** - Placement, movement, ownership
4. **Real-Time Sync** - WebSocket-based state synchronization
5. **Chat** - Text chat with channels
6. **Streaming** - Twitch/YouTube/Kick integration
7. **Marketplace** - Foundation only (monetization deferred)

### Key Decisions Made

| Topic | Decision |
|-------|----------|
| Premium Tier | Deferred - build value first, monetize later |
| Game Systems | No specific system for MVP - mock rules to validate architecture |
| Maps | Custom uploads + server-generated; GM-configurable grid snapping |
| Voice/Video | Not MVP - users can use Discord |
| Scene Management | GM-controlled + trigger zones (advanced feature) |
| Combat | Generic system to support specific game rules later |

### Deferred to Post-MVP
- Premium tier/monetization
- Specific game systems (D&D 5e, PF2e, Daggerheart)
- Voice/video chat
- Journal/handout system
- Compendium system
- Content moderation
- Accessibility features
- Analytics dashboards

## Tech Stack Finalized

After evaluating pros/cons of each option, confirmed the following stack:

| Layer | Technology | Rationale |
|-------|------------|-----------|
| **Frontend** | Svelte + SvelteKit | No VDOM overhead, built-in stores for WebSocket state, 1.6KB bundle |
| **Canvas** | PixiJS v8 | Proven in Foundry VTT, WebGL 60 FPS with 100+ tokens, WebGPU support |
| **Backend** | Fastify | Mature WebSocket plugin, 2-3x faster than Express, great TypeScript |
| **Database** | PostgreSQL | Structured data + JSONB for game-specific fields |
| **ORM** | Drizzle | Type-safe, lightweight, great PostgreSQL support |
| **Cache** | Redis | Sessions, pub/sub for real-time, caching |
| **Real-time** | @fastify/websocket | Route-based WebSocket handlers |

### Development Environment
- **Monorepo**: Turborepo + pnpm
- **Bundler**: Vite
- **Testing**: Vitest + Playwright
- **Linting**: ESLint + Prettier
- **Containers**: Docker Compose

Full specifications documented in `docs/architecture/TECH_STACK.md`

## Development Environment Setup

### Monorepo Structure Created
```
D:\Projects\VTT\
├── apps/
│   ├── web/              # SvelteKit frontend (port 5173)
│   └── server/           # Fastify backend (port 3000)
├── packages/
│   ├── shared/           # Shared types and utilities
│   └── database/         # Drizzle ORM schema
├── package.json          # Root package.json with Turborepo
├── pnpm-workspace.yaml   # pnpm workspace config
├── turbo.json            # Turborepo pipelines
├── .env                  # Environment variables
└── .gitignore
```

### Database Setup
- Using existing PostgreSQL container (`trading_platform_db`)
- Created `vtt` database with tables:
  - `users` - User accounts
  - `sessions` - User sessions
  - `games` - Game sessions
  - `tokens` - Game tokens

### Verification Results
- Backend server: ✅ Builds and runs successfully
- Health endpoint: ✅ Returns `{"status":"ok"}`
- API v1 endpoint: ✅ Returns version info
- Frontend: ✅ Builds successfully
- Database migrations: ✅ Applied via Drizzle

### How to Run
```bash
# Install dependencies
pnpm install

# Start development (both frontend and backend)
pnpm dev

# Or start individually:
cd apps/server && pnpm dev  # Backend on port 3000
cd apps/web && pnpm dev     # Frontend on port 5173

# Database commands
cd packages/database
DATABASE_URL='postgresql://claude:Claude^YV18@localhost:5432/vtt' pnpm db:push
```

## Bug Fixes

### Turborepo Configuration
- Fixed `turbo.json`: Renamed `pipeline` to `tasks` for Turborepo 2.x compatibility

### CLAUDE.md Updated
- Added database credentials to CLAUDE.md for future session reference
- PostgreSQL: `claude` / `Claude^YV18` on `trading_platform_db`
- Redis: `trading_platform_redis` on port 6379

## Current Status

- Project documentation structure: **Complete**
- Architecture documentation: **Comprehensive** (7 detailed specs)
- MVP scope: **Defined** (see docs/MVP_SCOPE.md)
- Tech stack: **Finalized** (see docs/architecture/TECH_STACK.md)
- Development environment: **Complete and verified**
- All infrastructure configured and working

## Next Steps

### Immediate (MVP Priority Order)
1. **Implement Dice System** - Universal dice parser and roller
   - Support standard notation (2d6+3, 4d6kh3, etc.)
   - WebSocket integration for real-time roll broadcasting
   - Roll history and formatting

2. **Implement Map System** - Canvas-based map display
   - PixiJS integration with Svelte
   - Image upload for custom maps
   - Grid overlay (square/hex) with GM-configurable snapping

3. **Implement Token System** - Draggable game pieces
   - Token CRUD operations
   - Real-time position sync via WebSocket
   - Ownership and visibility permissions

4. **Integrate Real-Time Sync** - WebSocket state management
   - Game room joining/leaving
   - State broadcasting to connected clients

### Technical Prerequisites
- Add PixiJS to frontend dependencies
- Create canvas component wrapper for Svelte
- Implement WebSocket room management on backend

---

**Session End**: Project fully initialized. Development environment complete and verified. Ready to begin MVP feature development starting with Dice System.
